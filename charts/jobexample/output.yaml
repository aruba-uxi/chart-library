---
# Source: jobexample/templates/worker.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: pi-with-timeout
  labels:
    name: pi-with-timeout
    app: jobexample
    repo: chart-library
    version: 0.1.11
spec:
  replicas: 1
  selector:
    matchLabels:
      app: pi-with-timeout
  template:
    metadata:
      labels:
        name: pi-with-timeout
        app: jobexample
        repo: chart-library
        version: 0.1.11
    spec:
      revisionHistoryLimit: 3
      containers:
      - name: pi-with-timeout
        image: perl
        imagePullPolicy: Always
        command: ["perl","-Mbignum=bpi","-wle","print bpi(2000)"]
        env:  
        - name: CAPE_ROLE
          value: "DEV"    
        - name: HOST_IP
          valueFrom:
           fieldRef:
             fieldPath: status.hostIP
        resources:
          limits:
            cpu: 10m
            memory: 200Mi
      restartPolicy: Never
---
# Source: jobexample/templates/job.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: pi-with-timeout
  labels:
    name: pi-with-timeout
    app: jobexample
    repo: chart-library
    version: 0.1.11
spec:
  template:
    metadata:
      name: pi-with-timeout
      labels:
        name: pi-with-timeout
        app: jobexample
        repo: chart-library
        version: 0.1.11
    spec:
      containers:
      - name: pi-with-timeout
        image: perl
        imagePullPolicy: Always
        command: ["perl","-Mbignum=bpi","-wle","print bpi(2000)"]
        env:  
        - name: CAPE_ROLE
          value: "DEV"    
        - name: HOST_IP
          valueFrom:
           fieldRef:
             fieldPath: status.hostIP
        resources:
          limits:
            cpu: 10m
            memory: 200Mi
      restartPolicy: Never
