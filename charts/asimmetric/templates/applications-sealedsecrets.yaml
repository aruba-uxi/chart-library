{{- range $name, $data := .Values.applications }}
{{- $sealedSecrets := deepCopy $.Values.global.envSealedSecrets | mustMerge (default dict $data.envSealedSecrets) }}
{{- range $secretName, $secretData := $sealedSecrets }}
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: {{ include "sealedSecret.name" (dict "context" $ "name" $name "secretName" $secretName)}}
  labels:
    {{- include "application.labels" (dict "context" $ "name" $name) | nindent 4 }}
spec:
  encryptedData:
    {{- range $secretKey, $secretValue := $secretData }}
    {{ $secretKey }}: {{ $secretValue }}
    {{- end }}
{{- end }}
{{- end }}
